{% extends "user_app/base.html" %}
{% block content %}
<div class="container m-5">
    <div class="row g-4 mb-5">
        <div class="col-md-4">
            <div class="card shadow-sm text-center p-3">
                <h5 class="card-title">Total Bookings</h5>
                <p class="display-4">{{ total_bookings }}</p>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card shadow-sm text-center p-3">
                <h5 class="card-title">Pending Works</h5>
                <p class="display-4">{{ pending_count }}</p>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card shadow-sm text-center p-3">
                <h5 class="card-title">Emergency Works</h5>
                <p class="display-4">{{ emergency_count }}</p>
            </div>
        </div>
    </div>
    <h2 class="text-center text-primary mb-4">Allocate Pending Services</h2>

    {% if messages %}
        {% for message in messages %}
            <div class="alert alert-{{ message.tags }}">{{ message }}</div>
        {% endfor %}
    {% endif %}

    <table class="table table-striped">
  <thead>
    <tr>
      <th>User</th>
      <th>Service</th>
      <th>Crew</th>
      <th>Company</th>
      <th>Status</th>
      <th>Emergency</th>
    </tr>
  </thead>
  <tbody>
    {% for booking in bookings %}
    <tr class="{% if booking.is_emergency %}table-danger{% endif %}">
      <td>{{ booking.user.username }}</td>
      <td>{{ booking.service.name_of_service }}</td>
      <td>{{ booking.crew.h_services|default:"-" }}</td>
      <td>{{ booking.company|default:"-" }}</td>
      <td>{{ booking.status }}</td>
      <td>{{ booking.is_emergency|yesno:"Yes,No" }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>

  </div>
</div>
{% endblock content %}
